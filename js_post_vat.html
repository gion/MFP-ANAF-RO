<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Post Ro-VAT</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
  </head>
  <body>
  	<script type="application/javascript">
      async function sync_anaf_vat_api(cui) {
          const today = new Date().toISOString().slice(0, 10);
          //const url = 'https://webservicesp.anaf.ro/PlatitorTvaRest/api/v8/ws/tva';
          //const url='https://webservicesp.anaf.ro/AsynchWebService/api/v8/ws/tva';
          var url='https://www.verificaretva.ro/api/apiv5.aspx?key=&cui='+cui+'&data='+today+'&bilant=0&realtime=0&lang=en';
          const headers = {
              'Accept': 'application/json',
              'Accept-Language': 'en-US,en;q=0.7,ro;q=0.3',
              'Connection': 'keep-alive',
              //'Referer': 'https://mfinante.gov.ro',
              'Content-Type': 'application/json',
          };
          //const data = [{ 'cui': cui, 'data': today }];
          var my_query={
                  //method: 'POST',
                  method: 'GET',
                  headers: headers,
                  //body: JSON.stringify(data),
          };
          try {
              const response = await fetch(url, my_query);
      
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
      
              const result = await response.json();
              console.log('TVA API Response:', JSON.stringify(result));
              return result;
          } catch (error) {
              console.log('There was a problem with the fetch operation:', error);
          }
      }
            
      if (window.fetch) {
        // run my fetch request here
        
        const cui= '41433222';
        let url=
        //sync_anaf_vat_api(cui);
          
        const today = new Date().toISOString().slice(0, 10);
        let url = 'https://www.verificaretva.ro/api/apiv5.aspx?key=&cui='+cui+'&data='+today+'&bilant=0&realtime=0&lang=en';
        
        fetch(url)
        .then(res => res.json())
        .then(out =>
          console.log('Checkout this JSON! ', out))
        .catch(err => { throw err }); 
        
      } else {
        alert("DO not have support for 'fetch'... !");
      }
  </script>
  </body>
</html>
