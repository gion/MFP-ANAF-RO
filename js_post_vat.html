<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Post Ro-VAT</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
  </head>
  <body>
  	<script type="application/javascript">
      async function async_anaf_vat_api(cui) {
          //const url = 'https://webservicesp.anaf.ro/PlatitorTvaRest/api/v8/ws/tva';
          const url='https://webservicesp.anaf.ro/AsynchWebService/api/v8/ws/tva';
          const headers = {
              'Accept': 'application/json',
              'Accept-Language': 'en-US,en;q=0.7,ro;q=0.3',
              'Connection': 'keep-alive',
              'Referer': 'https://mfinante.gov.ro',
              'Content-Type': 'application/json',
          };
          const today = new Date().toISOString().slice(0, 10);
          const data = [{ 'cui': cui, 'data': today }];
          var my_query={
                  method: 'POST',
                  headers: headers,
                  body: JSON.stringify(data),
          };
          try {
              const response = await fetch(url, my_query);
      
              if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
      
              const result = await response.json();
              console.log('TVA API Response:', JSON.stringify(result));
              return result;
          } catch (error) {
              console.log('There was a problem with the fetch operation:', error);
          }
      }
            
      if (window.fetch) {
        // run my fetch request here
        cui= '41433222';
        async_anaf_vat_api(cui);
      } else {
        alert("DO not have support for 'fetch'... !");
      }
  </script>
  </body>
</html>
